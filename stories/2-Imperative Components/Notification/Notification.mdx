import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as NotificationStories from './Notification.stories';

<Meta of={NotificationStories} />

# Notification

> **Note:** This is not a React component. This is more of a service.

Notification component can be used to give feedback to the user in an unobtrusive way of certain
event, like success of a delete operation or a new message has arrived in inbox. The notification is
rendered on the topmost layer and so any modal/dialog/drawer will open under it, i.e, it is always on top.
A notification can have max height of 150px only.

I again took imperative approach for this. Anywhere in the application, developer can call Notification
with `add`/`remove`/`destroy` operation. The rendering is done in a separate react application. This means
that state and context can not be shared between notification and the rest of the app. Developer will have
to rely on callbacks. This in my opinion should not be a problem as notification should only be used as a
feedback and should not have context of the application in any way.

## Types

I followed the standard for creating different types of notifications, i.e, `info`, `success`, `warning`,
and `error`. They all function in the same fashion but have subtle colour differences.

<Canvas of={NotificationStories.Types} className="canvas-background" />

## Position

Notification can be spawned in any four corner of the page and subsequent notification in the same corner
are stacked. Once all the notification in that corner is dismissed, the addition `div` node is cleared from
the DOM.

<Canvas of={NotificationStories.Position} className="canvas-background" />

## Features

A notification can be sticky, can have a action button or even have a callback when the notification
is closed. I also exposed an `id` prop, which can be used to de-duplicate notifications. This can be
useful in scenarios like when your app checks for a new version and creates a notification for the user.
Using the `id` prop, the developer doesn't need to maintain state to check if the notification was already
shown to the user. However, if the notification is dismissed, on subsequent call it will again be shown
to the user.

<Canvas of={NotificationStories.Features} className="canvas-background" />

```jsx
import { Notification, NOTIFICATION_POSITION, NOTIFICATION_TYPE } from 'no-frills-ui';

// Add a notification
// It returns an id which can be used to programmatically dismiss the notification.
const id = await Notification.add(NOTIFICATION_POSITION.TOP_RIGHT, {
    title: 'New message received',
    description: 'Please share feedback if you like this approach.',
    type: NOTIFICATION_TYPE.INFO,
});

// Remove a notification
Notification.remove(NOTIFICATION_POSITION.TOP_RIGHT, id);

// Destroy stack of notification
Notification.destroy(NOTIFICATION_POSITION.TOP_RIGHT);
```

## `Notification` options

<Controls of={NotificationStories.Options} />

## CSS Variables used

| Variable Name            | Description                  |
| :----------------------- | :--------------------------- |
| `--nfui-background`      | Used for `background-color`. |
| `--nfui-shadow`          | Used for `box-shadow`.       |
| `--nfui-info`            | Used for `color`.            |
| `--nfui-info-light`      | Used for `border-color`.     |
| `--nfui-success`         | Used for `color`.            |
| `--nfui-success-light`   | Used for `border-color`.     |
| `--nfui-warning`         | Used for `color`.            |
| `--nfui-warning-light`   | Used for `border-color`.     |
| `--nfui-error`           | Used for `color`.            |
| `--nfui-error-light`     | Used for `border-color`.     |
| `--nfui-primary-light`   | Used for `box-shadow`.       |
| `--nfui-text-color-dark` | Used from `color`.           |

## Accessibility

The Notification component is designed to meet WCAG 2.1 AA accessibility requirements:

- **ARIA Roles & Live Regions:**
    - Uses two persistent live region containers (present in DOM before notifications appear).
    - Warning and danger notifications use `role="alert"` with `aria-live="assertive"` for immediate announcement.
    - Info and success notifications use `role="log"` with `aria-live="polite"` for sequential, non-disruptive announcement.
    - Content is cleared and re-added with a 150ms delay to ensure reliable VoiceOver detection.
    - Alert region uses `aria-atomic="true"` to announce complete urgent messages.
    - Log region uses `aria-atomic="false"` with `aria-relevant="additions text"` to announce only new content.
    - Only the most recent notification is announced to avoid overwhelming screen reader users.
- **Structured Content:**
    - Multiple notifications are presented as a list (`role="list"` with `role="listitem"`).
    - Screen readers receive announcements from dedicated live regions, not visual elements.
- **Keyboard Accessibility:**
    - Close button is keyboard accessible (`tabIndex={0}`) with proper focus indication.
    - Close button has `aria-label="Close notification"` for screen readers.
    - Users can navigate between notifications using standard list navigation.
- **Non-Disruptive:**
    - Notifications don't trap focus, allowing users to continue their workflow.
    - Notifications auto-dismiss (configurable) to avoid cluttering the screen.
    - Pause on hover prevents premature dismissal during interaction.
- **Developer Responsibilities:**
    - Use appropriate notification types (warning/danger for urgent, info/success for non-urgent).
    - Keep notification text concise and descriptive.
    - Ensure custom themes meet color contrast requirements for text and icons (minimum 4.5:1 ratio).
    - Test with screen readers to verify announcements work as expected.
