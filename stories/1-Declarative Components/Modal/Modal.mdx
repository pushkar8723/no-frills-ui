import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as ModalStories from './Modal.stories';

<Meta of={ModalStories} />

# Modal

Component that renders in another layer. I used a custom layer manager for this. This ensures that the
modal always renders on top of whatever is opened without any need of `z-index` attribute.

I also exported `ModalHeader`, `ModalBody` and `ModalFooter` components. These are there only to help with
styling the modal and adds no additional functionality.

**Why is there a `Dialog` component?**

`Modal` takes declarative approach to manage component's state. Whereas `Dialog` take an imperative approach.
This is because a lot of time we just want to show/get certain information to/from the user in an async way
and then continue with our work. Having a declarative approach fragments the logic in such cases. However, I
didn't want to have a component that does both. Hence, the two component to power the same user experience.
But at the same time enhancing the developer experience at the cost of one additional component.

<div>{ModalStories.Demo.render()}</div>

```jsx
import { useState } from 'react';
import { Modal, ModalBody, ModalFooter } from 'no-frills-ui';

const [open, setOpen] = useState(false);

// render
<Modal open={open} onClose={() => setOpen(false)}>
    <ModalBody>This will always render on top.</ModalBody>
    <ModalFooter>
        <button onClick={() => setOpen(false)}></button>
    </ModalFooter>
</Modal>;
```

## `Modal` Props

<Controls of={ModalStories.Primary} />

## CSS Variables used

| Variable Name           | Description                  |
| :---------------------- | :--------------------------- |
| `--nfui-backdrop-color` | Used for `background-color`. |
| `--nfui-modal-shadow`   | Used for `box-shadow`.       |
| `--nfui-background`     | Used for `background-color`. |

## Accessibility

The Modal component is designed to be **WCAG 2.1 AA compliant**. It follows the [WAI-ARIA Dialog (Modal)](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/) pattern.

### ARIA Attributes

- **Role**: The modal is identified as a dialog using `role="dialog"`.
- **Modal**: The `aria-modal="true"` attribute is used to indicate that the modal traps focus.

### Focus Management

- **Focus Trap**: When the modal is open, focus is constrained within the modal to prevent users from interacting with the background content.
- **Initial Focus**: Focus is automatically set to the first focusable element inside the modal (or the modal header) when it opens.
- **Focus Restoration**: When the modal is closed, focus is restored to the element that triggered the modal.

### Keyboard Support

| Key   | Action                                     |
| :---- | :----------------------------------------- |
| `Esc` | Closes the modal and restores focus.       |
| `Tab` | Moves focus to the next focusable element. |
