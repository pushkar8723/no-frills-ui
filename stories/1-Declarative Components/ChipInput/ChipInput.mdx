import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as ChipInputStories from './ChipInput.stories';

<Meta of={ChipInputStories} />

# ChipInput

A text input field that allows users to enter and manage multiple values as removable chips.
Users can add new values by typing and pressing Enter, remove individual chips by clicking
their close button, and reorder chips via drag-and-drop.

The component automatically handles duplicate prevention and supports standard input features
like labels, validation, error messages, required fields, and disabled states.

<Canvas of={ChipInputStories.Variants} />

## Props and Ref

All additional `props` and `ref` to `ChipInput` component is forwarded to the native `input` element.
Following props are added on top of `HTMLInputElement` props.

<Controls of={ChipInputStories.Primary} />

## CSS Variables Used

| Variable Name                | Description                                        |
| :--------------------------- | :------------------------------------------------- |
| `--nfui-primary`             | Used for `color` and `border-color`.               |
| `--nfui-primary-light`       | Used for `box-shadow`.                             |
| `--nfui-error`               | Used for `color` and `border-color`.               |
| `--nfui-error-light`         | Used for `box-shadow` and `outline`.               |
| `--nfui-background`          | Used for `background-color` (input and chip text). |
| `--nfui-border-color`        | Used for `border-color`.                           |
| `--nfui-disabled-border`     | Used for disabled `border-color`.                  |
| `--nfui-disabled-background` | Used for disabled `background-color`.              |
| `--nfui-disabled`            | Used for disabled `color`.                         |

## Accessibility

This component meets **WCAG 2.1 Level AA** standards.

### Keyboard Navigation

- **Text Input**: Standard keyboard input with Enter to add chips
- **Tab Navigation**: Tab through input field and chip close buttons
- **Chip Removal**: Click close button or press Backspace/Delete while focused on button
- **Drag & Drop**: Visual reordering & keyboard reordering.

### Screen Reader Support

- **Live Announcements**: Chip additions and removals are announced via `aria-live` regions
- **Chip List**: Chips are presented as a semantic list with proper `role="listitem"`
- **Custom Labels**: Each chip's close button has descriptive `aria-label` (e.g., "Remove JavaScript")
- **Error Association**: Error messages are programmatically linked to the input via `aria-describedby`
- **Invalid State**: Input exposes `aria-invalid="true"` when errors are present

### Error Handling

- **Visual**: Errors displayed below input with error color and styling
- **Programmatic**: Errors linked to input via unique ID and `aria-describedby`
- **State Indication**: `aria-invalid` attribute indicates validation state

### Internationalization (i18n)

The component supports custom messages for screen reader announcements:

- **`closeButtonAriaLabel`**: Customize close button label.
- **`addedAnnouncementTemplate`**: Customize add announcement.
- **`removedAnnouncementTemplate`**: Customize remove announcement.

All templates support `{:label}` placeholder syntax for the chip value.

Example with i18n:

```tsx
<ChipInput
    label="Ingrese sus habilidades"
    closeButtonAriaLabel="Eliminar {:label}"
    addedAnnouncementTemplate="Se agregó {:label}"
    removedAnnouncementTemplate="Se eliminó {:label}"
/>
```
